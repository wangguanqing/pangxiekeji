!function(){function loadScript(e,t){var a,i=document.head;a=document.createElement("script"),a.async=!1,a.type="text/javascript",a.charset="utf-8",a.src=e,i.insertBefore(a,i.firstChild),t&&a.addEventListener("load",function(){postMessageToIframe({action:"jsCallback",callbackId:t})},!1)}function loadStyle(e,t){var a,i=document.head;a=document.createElement("link"),a.rel="stylesheet",a.type="text/css",a.href=e,i.appendChild(a),t&&script.addEventListener("load",function(){postMessageToIframe({action:"cssCallback",callbackId:t})},!1)}function injectStyle(e){var t=document.head,a=document.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=e:a.innerHTML=e,t.appendChild(a)}function addAnalytics(){iframe=document.createElement("iframe"),iframe.src="http://m.toutiao.com/tongji/?group_id="+TouTiao.articleId+"&page=/partner/"+location.hostname,iframe.style.position="absolute",iframe.style.top="-9999px",iframe.style.width="100%",iframe.style.visibility="hidden",iframe.style.opacity="0",iframe.style.border="0";var lazyLoadNewsTimeId=null;iframe.onload=function(){lazyLoadNewsTimeId=setTimeout(function(){addRelatedArticle()},500),postMessageToIframe({action:"iframeReady"})},theBody.appendChild(iframe),window.addEventListener("message",function(event){if("http://m.toutiao.com"==event.origin){var data={};try{data=JSON.parse(event.data)}catch(e){}switch(data.action){case"evalJS":var js=data.content;eval(js);break;case"injectStyle":injectStyle(data.content);break;case"loadStyle":loadStyle(data.url);break;case"loadScript":loadScript(data.url)}}},!1)}function addRelatedArticle(){var e=document.createElement("script");e.src="http://m.toutiao.com/group/article/"+TouTiao.articleId+"/related/?ad_num=2&offset=0&count=13&format=html&tt_from=weixin&callback=TouTiao.appendRelateArticle&partner="+location.hostname,document.querySelector("head").appendChild(e)}function appendRelateArticle(e){if(e.return_count&&e.html&&!document.getElementById("pageletRelateNews")){toutiaoRelateArticle.innerHTML+="<div class='s_support'>以下内容由今日头条提供</div>",toutiaoRelateArticle.innerHTML+="<div class='s_title'>相关阅读</div>",toutiaoRelateArticle.innerHTML+="<div class='s_content relate_news'>"+e.html+"</div>";var t=toutiaoRelateArticle.querySelector(".article_app_special"),a=(toutiaoRelateArticle.querySelector(".app_promotion_download"),toutiaoRelateArticle.querySelector(".download-custome-btn"),function(e){var e=e.preventDefault(),t=this.href;setTimeout(function(){location.href=t},400)});t&&(t.onclick=a)}}var postMessageToIframe=function(e){try{iframe.contentWindow.postMessage(JSON.stringify(e),iframe.src)}catch(t){}},iframe=null,toutiaoRelateArticle=document.createElement("section"),theBody=document.querySelector("body");toutiaoRelateArticle.id="toutiaoRelateArticle",theBody.appendChild(toutiaoRelateArticle),TouTiao.appendRelateArticle=appendRelateArticle,TouTiao.articleId&&addAnalytics()}();